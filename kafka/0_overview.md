# 카프카 개요

- [카프카 개요](#카프카-개요)
  - [탄생 배경](#탄생-배경)
  - [링크드인의 요구사항](#링크드인의-요구사항)
    - [요구사항 실현 수단](#요구사항-실현-수단)
      - [메시징 모델과 스케일 아웃](#메시징-모델과-스케일-아웃)
        - [요구 사항](#요구-사항)
        - [구성 요소](#구성-요소)
      - [디스크로의 영속화](#디스크로의-영속화)
        - [요구 사항](#요구-사항-1)
      - [이해하기 쉬운 API 제공](#이해하기-쉬운-api-제공)
        - [요구 사항](#요구-사항-2)
      - [전달 보증](#전달-보증)
        - [요구 사항](#요구-사항-3)
        - [전달 보증 수준](#전달-보증-수준)
  - [정리](#정리)

> Apache Kafka is a distributed streaming platform

대량의 데이터를 처리하는 분산 메시징 시스템이다.	

![kafka](images/0_kafka.svg)

 

카프카는 대량의 데이터를 높은 처리량과 실시간으로 처리해야 하기 때문에 4가지 특징을 가진다.

- 확장성(scale out)
- 영속성: 데이터를 `disk`에 저장
- 유연성: 다양한 제품과 쉽게 연동
- 신뢰성: 메시지 전달 보증

## 탄생 배경
카프카는 링크드인에서 로그를 처리하여 웹사이트 활동을 추적하는 것을 목적으로 개발되었다.
카프카 이전에도 IBM WebSphere MQ, Apache ActiveMQ, RabbitMQ와 같은 여러 메시징 시스템들이 존재했지만 링크드인의 요구사항에 부합하지 않았다.

## 링크드인의 요구사항

- 높은 처리량으로 실시간 처리
- 임의의 타이밍에 데이터를 조회
  - 데이터를 사용하는 타이밍이 반드시 실시간이 아니라 이용 목적에 다라 다를 가능성이 있기 때문
- 다양한 제품과 시스템에 쉽게 연동
- 메시지 분실 방지

### 요구사항 실현 수단
#### 메시징 모델과 스케일 아웃
##### 요구 사항
- 높은 처리량으로 실시간 처리
- 임의의 타이밍에 데이터를 조회
- 다양한 제품과 시스템에 쉽게 연동

##### 구성 요소
- Producer: 메시지 생산자
- Broker: 메시지 수집/전달 역할
- Consumer: 메시지 소비자
- Consumer Group: 동일 토픽을 분산하여 읽음으로써 처리의 확장성 제공
  - 단, 브로커가 1대라면 병목이 될 수 있음.
  - 복수의 브로커 운영

#### 디스크로의 영속화
##### 요구 사항
- 임의의 타이밍에 데이터 조회
- 메시지 분실 방지

#### 이해하기 쉬운 API 제공
##### 요구 사항
- 다양한 제품과 시스템에 쉽게 연동

#### 전달 보증
##### 요구 사항
- 메시지 분실 방지

##### 전달 보증 수준
|     종류      |       개요        | 재전송 | 중복 삭제 |                       비고                       |
| :-----------: | :---------------: | :----: | :-------: | :----------------------------------------------: |
| At Most Once  |  1회는 전달 시도  |   X    |     X     |    메시지는 중복되지 않지만 상실될 수도 있다.    |
| At Least Once | 적어도 1회는 전달 |   O    |     X     | 메시지가 중복될 가능성은 있지만 상실되진 않는다. |
| Exactly Once  |    1회만 전달     |   O    |     O     |  중복되거나 상실되지 않지만 성능에서 불리하다.   |


## 정리
위의 특징 때문에 오늘날 카프카를 사용하는 기업들이 점점 늘고 있다.  
대표적으로 링크드인, 구글, 드롭박스, 넷플릭스 등 수 많은 회사에서 사용하고 있다.
